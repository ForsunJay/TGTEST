Разработка чат-бота для учета расходов
Авторизация
Вход по Telegram ID
Разделение ролей:
Пользователь - может создавать заявки (для сотрудников) 
Администратор - может просматривать и выгружать заявки, а также самостоятельно создавать заявки (для ФМ) 
Финконтроль — только просмотр и экспорт (КЭ, ЛВ)


Для пользователя:
1.Создание заявки
Бот запускает пошаговый диалог. Пользователь отвечает на запросы бота, чтобы сформировать заявку.
Шаги:
 1. Выбор проекта
→ Бот предлагает список активных проектов из справочника
ВАРИАНТЫ: 
* 🇷🇺 МФ РФ ( ЯР / НН/ Общий) 
* 🇰🇿 МФ КЗ 
* 🇦🇲 МФ АМ
* 🌐 МФ ВОРЛД
*  2. Ввод суммы и валюты
→ Бот предлагает список валют из справочника
ВАРИАНТЫ: 
* Рубль 
* Тенге 
* Драм 
* USD 
* EUR 
* USDT 
→ Пользователь вписывает сумму в окно для ввода (цифрой)
→ Обеспечить автоматический пересчет введенной суммы в базовую валюту проекта (МФ КЗ - тенге, МФ РФ - рубли, МФ АМ - драм, МФ ВОРЛД - доллары) по актуальному курсу (из гугл.)
Итоговые суммы будут обе
Пример: 
Cумма: 48012,32 рублей (300000 тенге)


 3. Выбор источника средств
→ Бот предлагает список источников из справочника
ВАРИАНТЫ:
* РС РФ Сервис+ Точкабанк 
* РС ТОО КЗ
* РС ИП КЗ
* Карта ТОО КЗ
* Карта ИП КЗ
* РС ООО АМ
* РС ООО АМ EUR
* Карта ООО АМ
* Крипта
* Наличные


4. бот предлагает Прикрепить счет для оплаты ( загрузить документ) или Отправить на счет партнера. ( Счет самозанятого ФИО / ИП ФИО) 


 5. Примечание
→ Пользователь может вручную ввести текстовое примечание для расходов. 
А также предлагает список примечаний из справочника, такие как: 
* Реклама.
* Сопровождение РК.
* Ком-ции. СМС:
* Ком-ции. АВТОДОЗВОНЫ:
* Ком-ции. РАССЫЛКИ:
* Ком-ции. ТЕЛЕФОНИЯ:
* Ком-ции. ОНЛАЙН:
Пример: Ком-ции. СМС: Эдбот. Сервис для рассылки писем WA.


 6. Период оказания услуги 
→ Встроенный виджет-календарь, пользователь кликает по нужной дате или вводит вручную
+ Возможность пропустить данный шаг для единоразовых платежей 
Пример: с 05.05.2025 до 09.05.2025


 7. Дата расхода
→ Встроенный виджет-календарь, пользователь кликает по нужной дате
Пример: 05/05
 8. Подтверждение
Бот показывает собранную информацию и предлагает подтвердить или отредактировать.
 
Формат итоговой заявки:
Проект: МФ РФ
Cумма: 48012,32 рублей (300000 тенге)
Источник: РС ТОО КЗ
Кому*: (появляется в случае выбора : отправить на счет партнеру) 
Примечание: Ком-ции. СМС: Эдбот. Сервис для рассылки писем WA. Период с 05.05.2025 до 09.05.2025.
Дата: 05/05
















Для администратора:
Администраторы: 
* Алия
* Виктория
* Арина
1. Получение уведомлений о новых заявках
→ Бот должен автоматически определять, кому из администраторов направлять заявку, на основании следующих условий:


Условие 
	Ответственный администратор
	Источник: РС РФ (любой проект)
	Вика
	Источник: РС ТОО КЗ  (любой проект)
	Алия
	Источник: РС ИП КЗ  (любой проект)
	Алия
	Источник: РС ООО АМ  (любой проект)
	Алия, Арина
	Источник: РС ООО АМ EUR  (любой проект)
	Алия, Арина
	Источник: Карта ТОО КЗ  (любой проект)
	Алия
	Источник: Карта ИП КЗ  (любой проект)
	Алия
	Источник: Карта ООО АМ  (любой проект)
	Алия, Арина
	Источник: Наличные  (любой проект)
	Арина
	Источник: Крипта  (МФ РФ)
	Вика
	Источник: Крипта  (МФ КЗ/МФ ВОРЛД)
	Алия
	Источник: Крипта  (МФ АМ)
	Алия, Арина
	

→ Бот уведомляет администратора при каждой новой заявке 
→ Уведомление в виде краткой карточки
Пример:
Проект: МФ РФ
Cумма: 48012,32 рублей (300000 тенге)
Источник: РС ТОО КЗ


2. Просмотр заявки
→ При открытии карточки заявки администратор видит:
* Все поля, заполненные сотрудником
* Статус заявки 






Кнопки:
☑️ Ожидает платежа
✅ Подтвердить платеж - Прикрепить документ (опционально)
❌ Отклонить
📝 Редактировать
💬 Комментировать
☑️Ожидает платежа
Действие:
Администратор нажимает кнопку ☑️ Ожидает платежа
Что делает бот:
* Обновляет статус заявки на "Ожидает платежа"
* Отправляет сотруднику уведомление:


⏳ Ваша заявка находится в ожидании оплаты
                   * Заявка* 
 Статус: ☑️ Ожидает платежа


✅Подтвердить платеж
Действие:
Администратор нажимает кнопку ✅ Подтвердить платеж
Бот запрашивает у администратора:
* 📎 Загрузку файла (платежка, чек, скрин)
Что делает бот:
* Меняет статус заявки на "Оплачено"
* Сохраняет данные об оплате
* Отправляет сотруднику уведомление:
✅ Ваша заявка оплачена
                     * Заявка*  
📎 Платежный документ во вложении


❌ Отклонить 
Действие:
Администратор нажимает кнопку ❌ Отклонить
Бот запрашивает:
* 📝 Обязательное поле для ввода причины отклонения
(без заполнения поле не дает продолжить действие)
Что делает бот:
   * Присваивает заявке статус: "Отклонена"
   * Фиксирует администратора и текст причины в истории заявки
   * Отправляет сотруднику уведомление следующего вида:
❌ Ваша заявка отклонена
                * Заявка*  
Причина отклонения:  
🔻 Неактуальная дата периода / неверный источник
Статус: ❌ Отклонена


❗️Заявка отклонена:
Причина: Сумма превышает лимит бюджета по проекту.
Причина: Не может быть оплачена в указанный день, повторите заявку завтра.

✏️Редактировать
Функция: ✏️ Редактировать
Доступ: Только у администратора, назначенного на заявку (по источнику).
Что делает бот:
При нажатии ✏️ Редактировать:
→  Открывается форма редактирования всех полей заявки:
   * 📌 Проект
   * 💰 Сумма
   * 💱 Валюта
   * 🏦 Источник
   * 📅 Период оказания услуг (календарь "с" и "по")
   * 📝 Примечание


→  После внесения изменений и нажатия "Сохранить", бот задаёт вопрос:
Заявка обновлена. Подтвердить её сразу?
 ✅ Да / ❌ Нет


→ После сохранения изменений бот отправляет сотруднику уведомление:
✏️ Ваша заявка была изменена администратором
                          * Заявка*  
🔄 Статус заявки: обновлен


→ Все изменения фиксируются в истории заявки (кто, когда, что поменял)


💬 Комментировать
→ Позволяет администратору:
   * Оставить комментарий к заявке на любом этапе
   * Ответить на вопрос сотрудника
   * Вести переписку внутри заявки (общение фиксируется и сохраняется в истории)
→ В карточке заявки администратор нажимает кнопку 💬 Комментировать
   1.  Открывается окно ввода текста
   2. После отправки:
   * Комментарий сохраняется в истории заявки
   * Сотруднику отправляется уведомление:


💬 Комментарий к заявке:
"Пожалуйста, уточните дату периода оказания услуг."  
— ФМ Виктория




3. История заявок
Функция: Позволяет администратору просматривать и фильтровать все заявки, поданные сотрудниками через чат-бота.
→  Просмотр всех заявок в виде списка
→  Создание фильтров по параметрам: 
   * По статусу (новые, оплаченные, отклоненные)
   * По проекту (МФ РФ/МФ КЗ/МФ АМ/МФ ВОРЛД)
   * По дате/периоду (Конкретная дата или диапазон (выбор календарём)
   * По источнику
   * По сотруднику 


4. Ежедневная отправка сводных заявок администраторам
Функция: Обеспечить администраторам автоматическую отправку сводных отчетов по заявкам — по каждому выбранному проекту и в заданное время.
→ При первом запуске или по команде /настройки_сводок бот предлагает выбрать проекты (выбрать можно несколько вариантов):
ВАРИАНТЫ: 
   * МФ РФ ( ЯР / НН/ Общий) 
   * МФ КЗ 
   * МФ АМ
   * МФ ВОРЛД
   * Все проекты 


→ Настройка времени отправки. После выбора каждого проекта бот спрашивает:
🕒 Во сколько отправлять сводку по “МФ РФ”?
Варианты: 18:00, 19:00, 20:00 (или ручной ввод)


→ Гибкое управление настройками. В команде /настройки_сводок админ может:
   * ✅ Включить / отключить проект
   * 🕒 Изменить время
   * 🔕 Приостановить отправку по проекту
   * 📅 Переключиться в ручной режим
→ Поведение бота (ежедневно). В заданное время по каждому проекту бот присылает отдельное сообщение:
Пример автоматической сводки:
Сводка по проекту: МФ РФ (09:00)
🆕 Новые: 2  
⏳ Ожидают платежа: 1  
✅ Оплачено: 1  
❌ Отклонено: 0


📝 Последние заявки:
*Заявка* 
*Заявка* 
*Заявка* 
→ Быстрые кнопки в сообщении:
   * ✏️ Перейти к заявке
   * 💬 Комментировать
   * ✅ Подтвердить
   * ❌ Отклонить












 5. Экспорт
Возможность выгрузки подтвержденных заявок в гугл таблицу (https://docs.google.com/spreadsheets/d/1ptEpclJPLppxtrg_-ANhGMu6tp5crnQmwsWF7UpvwN0/edit?usp=sharing )
Перенос по Шаблону.


6. Напоминания и задачи
→ Бот присылает напоминание:
   * Если заявка не рассмотрена за 24 часа
   * Если в течении 24 часов заявка в статусе “Ожидает платежа”, но платеж не проведен